# Projekt_Pentesty_aplikacji_webowej:

Stworzenie raportu z maszyny na platformi [tryhackme.com](https://tryhackme.com/).
Wybrane przeze mnie maszyny to:


# Sposób przejścia:
## [Psycho Break](https://tryhackme.com/room/psychobreak)

![](/scrin/PsychBreak.bmp)


Na wstępie sprawdzam jak ta aplikacja webowa wygląda w ```przeglądarce internetowej``` i sprawdzam kod źródłowy aplikacji za pomocą ```narzędzi deweloperskich```. Znajduje tam komentarz:
```
Sebastian sees a path through the darkness which leads to a room => /sadistRoom
```
 
 ![](/scrin/strona_glowna_pb.png)

 Jak widać kieruje on do podstrony ```/sadistRoom``` gdzie znalazłem 
 ```
 Key to locker Room => 532219a04ab7a02b56faafbec1a4c1ea
 ``` 
 zdobyłem odpowiedź na jedno pytanie.
 ![](/scrin/pb_sadistRoom.png)
 Klikniecie ``Ok`` przenosi do kolejnej podstrony.
 ![](/scrin/pb_sadistRoom_ok.png)

Idąc dalej w zbieranie informacji o atakowanym obiekcie uruchamiam narzędzie ```nmap``` poleceniem: 
```
sudo nmap -Pn -A -sV --script=default,vuln -p- --open -oA IP_nmap_vulns IP
```
następnie wyszukuje otwarte porty poleceniem:
```
└─$ cat nmap_10.10.16.153.nmap |  grep open
# Nmap 7.93 scan initiated Sat May  6 03:54:37 2023 as: nmap -Pn -A -sV --script=default,vuln -p- --open -oA nmap_10.10.16.153 10.10.16.153
21/tcp open  ftp     ProFTPD 1.3.5a
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)
|   cpe:/a:openbsd:openssh:7.2p2: 
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
```
![](/scrin/pb_nmap_str_glowna.png)
Mogę określić, że otwarte porty to 21 -ftp, 22 -ssh, 80 -thhp i system operacyjny to ```Ubuntu```. wiem już ile jest otwartych portów i znam system operacyjny.
Sprawdzę co pokaże mi narzędzie ```enum4linux``` z flaga ```-a``` i ```gobuster```.
![](/scrin/pb_enum4linux_gobuster_str_glowna.png)
Niestety po sprawdzeniu wszystkich znalezionych katalogów za pomoca ```gobuster```. Nic ciekawego nie znalazłem.
Postanowiłem zobaczyc co pokaże mi narzędzie ```zaproxy```, uruchomiłem automatyczne skanowanie na host ```http://10.10.16.153/``` 
po przejrzeniu wyników zrobiłem to samo dla hosta ```http://10.10.16.153/sadistRoom```
![](/scrin/pb_zaproxy_sadistRoom.png)
Znalazłem kolejną podstrone ```/lockerRoom``` i sprawdzam co się na niej znajduje w przeglądarce.
![](/scrin/pb_LockerRoom.png)
Podążając za podpowiedziami szukam możliwości do dekodowania wskazanego ciągu znaków. Pierwszą myślą kieruję się do narzędzia [ChatGPT](https://chat.openai.com/) 
![](/scrin/pb_dekodowania_ChatGPT.bmp)
jednak okazało sie, że to pytanie przerosło ```AI```. Szukam dalej tym razem za pomoca [google.pl](google.pl). Tym razem znajduje narzędzie [Vigenère Solver](https://www.guballa.de/vigenere-solver) zmieniałem w ciemno ustawienia ```Cipher Variant``` aż trafiłem na właściwe ustawienie.
![](/scrin/pb_dekodowania_narzedziem_google.bmp)

#### Niestety w między czasie wygasła mi ATAKOWANA_MASZYNA, po kolejnym uruchomieniu IP_MASZYNY będzie inne ale cała reszta którą odnalazłem będzie się zgadzać.
![](/scrin/pb_sadistRoom_to_map.png)
Dzieki temu dostalem się do zasobu ```map.php```.
![](/scrin/pb_map.png)
Dzięki temu mogę wejść w nowe katalogi takie jak ```Safe Haeven``` i ```The Abandoned Room``` ten drugi wymaga klucza więc skupiam się na ```Safe Heaven```.
![](/scrin/pb_SafeHeaven_and_AbandonedRoom.png)
Wracam do ```zaproxy``` i wyliczam automatycznie ```http://10.10.207.142/SafeHeaven/``` to mnie prowadzi do ```/imgs``` niestety nic tam ciekawego nie znajduję.
Postanowiłem spróbować jeszcze raz wyliczyć katalogi za pomocą ```gobuster``` za pomocą polecenia:
```
gobuster dir -u http://10.10.207.142/SafeHeaven/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```
Znalazłem katalog ```/keeper```, wróciłem do narzędzia ```zaproxy``` i ```przeglądarce```.
![](/scrin/pb_TheKeeper.png) 
Nastepnie przechodzę do katalogu ```Escape Keeper```, 
![](/scrin/pb_SaveYourself.png)
dalej zgodnie z podpowiedzią pobieram zdjęci i próbuje za pomoca narzędzia ```exiftool ``` znaleść w meta danych odpowiedź na pytanie.
```└─$ exiftool image.jpg                                             
ExifTool Version Number         : 12.57
File Name                       : image.jpg
Directory                       : .
File Size                       : 123 kB
File Modification Date/Time     : 2023:05:06 08:07:03-04:00
File Access Date/Time           : 2023:05:06 08:07:47-04:00
File Inode Change Date/Time     : 2023:05:06 08:07:04-04:00
File Permissions                : -rw-r--r--
File Type                       : JPEG
File Type Extension             : jpg
MIME Type                       : image/jpeg
Exif Byte Order                 : Big-endian (Motorola, MM)
Current IPTC Digest             : 6346693198500c3ff8d4ad39d687fd7c
Coded Character Set             : UTF8
Envelope Record Version         : 4
Document Notes                  : https://flickr.com/e/6BbTLpAxA%2F7Z9%2F%2BJvhmSo6saBVRUN9xk874kPaPZVAM%3D
Application Record Version      : 4
JFIF Version                    : 1.02
Resolution Unit                 : None
X Resolution                    : 1
Y Resolution                    : 1
Image Width                     : 640
Image Height                    : 480
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:2 (2 1)
Image Size                      : 640x480
Megapixels                      : 0.307
```
Następny pomysł to przeciągnięcie zdjęcia do wyszukiwarki ```google.com```.
![](/scrin/pb_lokalizacja_zdj%C4%99cia.bmp)
![](/scrin/pb_flaga_po_znalezieniu_lokacji_zdjecia.png)
Takim sposobem zdobyłem dostęp do wcześniej nie dostępnego katalogu ```The Abandoned Room```, po wprowadzeniu danych uwierzytelniających zostałem przeniesiony na:
```
http://10.10.207.142/abandonedRoom/be8bc662d1e36575a52da40beba38275/index.php
```
![](/scrin/pb_AbandonedRoom.png)

Idąc dalej znalazłem ciekawą stronę która kazała mi uciakać. Postanowiłem wyliczyć ją za pomocą ```zaproxy```. Dzięki temu znalazłem kolejne zasoby takie jak ```//assets```.
Ciekawe czy ```gobuster``` znajdzie jakieś ukryte katalogi na podstronie 
```
http://10.10.207.142/abandonedRoom/be8bc662d1e36575a52da40beba38275/
```
![](/scrin/pb_herecomeslara.png)
Przeglądając kod bierzącej strony znalazłem komentarze:
```
There is something called "shell" on current page maybe that'll help you to get out of here !!! 
 ```
 ![](/scrin/pb_AbandonedRoom_opis.png)

 Podpowiedzi sugerują mi podatność [SQL injection (SQLi)](https://portswigger.net/web-security/sql-injection) możlieość wstrzykiwania komend w pasek poleceń. Idąc tym tropem spróbujmy spróbuję kilka poleceń.
Po sprawdzeniu kilku komend i przekonaniu się, że tylko mi działa ```ls``` inne które sprawdziłem i ```ls``` z jakim kolwiek parametrem okazały się być komendami niezanymi.
Nawet po zakodowaniu ```spacjii``` w ```html``` za pomocą ```%20``` lub ```&nbsp;```. Okazało się, polecenie ```ls``` jest jedynym działającym poleceniem. Działa ono również jako polecenie ```cd ../``` ale jako ```ls ..``` nie jak próbowałem phrzez dłuższy czas ```ls ../```, po chwili jak już udało mi się i patrzę na to rozwiązanie naszła mnie refleksja, że ```przegladarka internetowa``` po zatwierdzeniu ```url``` automatycznie na końcu dodaje na końcu znak ```/```.
![](/scrin/pb_herecomeslara_shell_ls.png)
Widzę listę katalogó. Wśród wylistowanych dwóch katalogów i jednego pliku, nie przeglądałem tylko pierwszego katalogu ```680e89809965ec41e64dc7e447f175ab```. Za pomocą tej nazwy i paska ```url``` przechodzę do tego katalogu.
![](/scrin/pb_AbandonedRoom_680e89809965ec41e64dc7e447f175ab.png)
Sprawdzam plik ```.txt``` w podobny sposób do przechodzenia do innych katalogów za pomocą paska ```url```.
![](/scrin/pb_AbandonedRoom_680e89809965ec41e64dc7e447f175ab_plik_w_przegladarce.png)
Pobrałem pliki które zaczynam badać już w terminalu.
Następnie rozpakowałem pobrane archiwum ```zip```. Następnie otwierając plik ```.txt``` który pobrałem z poprzedniej strony znalazłem wiadomość skierowaną do użytkownika ```Joseph```. Zakładam również, że to może być ```username```.
![](/scrin/pb_praca_w_terminalu_ftp_1.png)
następnie w ```GUI``` sprawdzam plik graficzny.
![](/scrin/pb_praca_w_terminalu_ftp_grafika.png)
Plik graficzny okazał się, kolejnym archiwym ```zip```. Okazuje się, że opis rozszerzenia w nazwie pliku nie detrminuje rzeczywistego rozszerzenia pliku.
![](/scrin/pb_praca_w_terminalu_ftp_grafika_2.png)
Dekodowanie pliku audio [.wav](/scrin/key.wav)
który zawiera nagranie zakodowane ```alfabetem morsa```. W wyszukaniu możliwości dekodowania plików audio z nagraną wiadomością w alfabecie morsa postanowiłem wykorzystać [CatGPT]().
```
Ja
jak zdekodować plik wav z kodem morsa?

ChatGPT
Aby zdekodować plik WAV z kodem Morse'a, możesz skorzystać z programu odtwarzającego dźwięk i transkrybującego sygnał dźwiękowy na tekst, lub z narzędzi dostępnych w linii komend.

Przykładowe narzędzia dostępne w linii komend do dekodowania kodu Morse'a z pliku WAV to np. "morse2txt" lub "morse". Aby z nich skorzystać, wykonaj następujące kroki:

Upewnij się, że narzędzia są zainstalowane na Twoim systemie (jeśli nie, możesz zainstalować je przy pomocy menadżera pakietów Twojej dystrybucji Linux).

Otwórz terminal i przejdź do katalogu, w którym znajduje się plik WAV z kodem Morse'a.

Wykonaj polecenie, aby przekonwertować plik WAV na tekst:

Copy code
morse2txt nazwa_pliku.wav
lub

Copy code
morse -d nazwa_pliku.wav
Po wykonaniu powyższego polecenia, na ekranie pojawi się zdekodowana wiadomość w kodzie Morse'a z pliku WAV.
Zauważ, że dekodowanie kodu Morse'a z pliku WAV może wymagać pewnego doświadczenia w odsłuchiwaniu sygnałów dźwiękowych oraz w interpretacji znaków w kodzie Morse'a.
```
![](/scrin/pb_chaygpt_rozkodowywanie_morsa.bmp)
Niestety z narzędziami ```Linuxsowymi``` miałem problem i nie chciało mi to działać. Dałem drugą szansę lecz tym razem sprecyzowałem swoje pytanie do narzędzie ```online```.
```
Ja
czy są jakieś online narzędzia to tego rozkodowania?

ChatGPT
Tak, istnieje wiele narzędzi online, które pozwalają na dekodowanie plików dźwiękowych z kodem Morse'a na tekst. Możesz spróbować użyć jednego z poniższych:

https://morsecode.world/international/decoder/audio-decoder-adaptive.html
https://morsecode.scphillips.com/labs/audio-decoder-adaptive/
https://morsecode.ninja/audio-decoder-adaptive/
Wymagają one przesłania pliku dźwiękowego (np. w formacie WAV) na serwer, który następnie przetwarza go na tekst.
```
Pierwsze narzedzie zadziałało idealnie. 
![](/scrin/pb_dekodowania_chatgpt-2.bmp)
![](/scrin/pb_rozkodowanie_morsa_online.bmp)
Mam już wiedzę o otwartych portach wraz z usługami, username: ```joseph``` i ip maszyny atakowanej. Moge teraz spróbować zaatakować słownikowo każdą z usług.
Zaczne od ```ftp``` za pomocą narzędzia ```hydra``` poleceniem:
```
hydra -t 4 -l joseph -P /usr/share/wordlists/rockyou.txt -vV 10.10.236.65 ftp
```
Ponieważ to bardzo długo trfa, zacząłem szukać innej opcjiza pomocą narzędzia ```steghide``` okazało się, że plik którego jeszcze nie wykorzystałem a był rzeczywistym zdjęciem ma w sobie ukrytą wiadomość ```.txt``` 
wydzieliłem ten plik i znalazłem tam hasło do ftp. Kończę pracę ```hydry```. Po zalogowaniu  pomocą zdobytych poświadczeć ```username: joseph, password: intotheterror445``` loguję się na ```ftp```.

Narzędziem ```steghide``` czy ukrywa się coś w pliku graficznym.
![](/scrin/pb_jpg2_1.png)
![](/scrin/pb_jpg2_2.png)
Następnie sprawcam do jakich katalogów mam dostęp. Okazuję się, że nie mogę poruszać się po katalogach więc pobieram wszystkie pliki do których mam dostęp i je badam.
Plik ```random.dic``` wygląda jak lista haseł, ciekawa rzecz się dzieje gdy sprawdzam czym jest plik ```program```
![](/scrin/pb_jpg2_3.png)
![](/scrin/pb_jpg2_4.png)
```
$ file program  
program: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=294d1f19a085a730da19a6c55788ec08c2187039, stripped
```
Wracam do ```ChatGPT``` sprawdzić co mi może powiedzieć na ten temat.
```
Ja
co to oznacza: $ file program  
program: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=294d1f19a085a730da19a6c55788ec08c2187039, stripped

ChatGPT
Polecenie file w Linuksie służy do określania typu pliku na podstawie jego zawartości. W przypadku wywołania file program, wynik informuje, że program jest plikiem wykonywalnym ELF (Executable and Linkable Format) przeznaczonym dla systemu Linux na architekturze x86-64 (64-bitowa). Plik jest dynamicznie linkowany, posiada interpreter /lib64/ld-linux-x86-64.so.2, jest przeznaczony dla systemu GNU/Linux w wersji 2.6.32, posiada unikalny identyfikator kompilacji i został "stripped" (usunięte zostały informacje debugowania).

Ja
co mogę zrobić z tym plikiem?

ChatGPT
To jest informacja o typie pliku, która została wygenerowana przez polecenie file. Plik program jest plikiem wykonywalnym (ELF), przeznaczonym dla systemu Linux (GNU/Linux). Zawiera kod maszynowy, który może być wykonany na procesorze x86-64.

Co dokładnie możesz zrobić z tym plikiem, zależy od twojego celu. Jeśli jest to program, którego działanie jest ci nieznane, możesz spróbować uruchomić go i zobaczyć, co się stanie. Możesz to zrobić, wpisując ./program.

Możesz także spróbować przeanalizować kod źródłowy programu, jeśli jest dostępny, aby zrozumieć, co robi. W każdym przypadku zalecam zachowanie ostrożności, ponieważ uruchomienie nieznanych programów z Internetu może być niebezpieczne.
```
